(function(e,t,n){var r=t.event,i;r.special.smartresize={setup:function(){t(this).bind("resize",r.special.smartresize.handler)},teardown:function(){t(this).unbind("resize",r.special.smartresize.handler)},handler:function(e,t){var n=this,r=arguments;e.type="smartresize",i&&clearTimeout(i),i=setTimeout(function(){jQuery.event.handle.apply(n,r)},t==="execAsap"?0:100)}},t.fn.smartresize=function(e){return e?this.bind("smartresize",e):this.trigger("smartresize",["execAsap"])},t.Slideshow=function(e,n){this.$el=t(n),this.$list=this.$el.find("ul.ei-slider-large"),this.$imgItems=this.$list.children("li"),this.itemsCount=this.$imgItems.length,this.$images=this.$imgItems.find("img:first"),this.$sliderthumbs=this.$el.find("ul.ei-slider-thumbs").hide(),this.$sliderElems=this.$sliderthumbs.children("li"),this.$sliderElem=this.$sliderthumbs.children("li.ei-slider-element"),this.$thumbs=this.$sliderElems.not(".ei-slider-element"),this._init(e)},t.Slideshow.defaults={animation:"sides",autoplay:!1,slideshow_interval:3e3,speed:800,easing:"",titlesFactor:.6,titlespeed:800,titleeasing:"",thumbMaxWidth:999},t.Slideshow.prototype={_init:function(e){this.options=t.extend(!0,{},t.Slideshow.defaults,e),this.$imgItems.css("opacity",0),this.$imgItems.find("div.ei-title > *").css("opacity",0),this.current=0;var n=this;this.$loading=t('<div class="ei-slider-loading">Loading</div>').prependTo(n.$el),t.when(this._preloadImages()).done(function(){n.$loading.hide(),n._setImagesSize(),n._initThumbs(),n.$imgItems.eq(n.current).css({opacity:1,"z-index":10}).show().find("div.ei-title > *").css("opacity",1),n.options.autoplay&&n._startSlideshow(),n._initEvents()})},_preloadImages:function(){var e=this,n=0;return t.Deferred(function(r){e.$images.each(function(i){t("<img/>").load(function(){++n===e.itemsCount&&r.resolve()}).attr("src",t(this).attr("src"))})}).promise()},_setImagesSize:function(){this.elWidth=this.$el.width();var e=this;this.$images.each(function(n){var r=t(this);imgDim=e._getImageDim(r.attr("src")),r.css({width:imgDim.width,height:imgDim.height,marginLeft:imgDim.left,marginTop:imgDim.top})})},_getImageDim:function(e){var t=new Image;t.src=e;var n=this.elWidth,r=this.$el.height(),i=r/n,s=t.width,o=t.height,u=o/s,a,f,l,c;return i>u?(f=r,a=r/u):(f=n*u,a=n),{width:a,height:f,left:(n-a)/2,top:(r-f)/2}},_initThumbs:function(){this.$sliderElems.css({"max-width":this.options.thumbMaxWidth+"px",width:100/this.itemsCount+"%"}),this.$sliderthumbs.show()},_startSlideshow:function(){var e=this;this.slideshow=setTimeout(function(){var t;e.current===e.itemsCount-1?t=0:t=e.current+1,e._slideTo(t),e.options.autoplay&&e._startSlideshow()},this.options.slideshow_interval)},_slideTo:function(e){if(e===this.current||this.isAnimating)return!1;this.isAnimating=!0;var n=this.$imgItems.eq(this.current),r=this.$imgItems.eq(e),i=this,s={zIndex:10},o={opacity:1};this.options.animation==="sides"&&(s.left=e>this.current?-1*this.elWidth:this.elWidth,o.left=0),r.find("div.ei-title > h2").css("margin-right","50px").stop().delay(this.options.speed*this.options.titlesFactor).animate({marginRight:"0px",opacity:1},this.options.titlespeed,this.options.titleeasing).end().find("div.ei-title > h3").css("margin-right","-50px").stop().delay(this.options.speed*this.options.titlesFactor).animate({marginRight:"0px",opacity:1},this.options.titlespeed,this.options.titleeasing),t.when(n.css("z-index",1).find("div.ei-title > *").stop().fadeOut(this.options.speed/2,function(){t(this).show().css("opacity",0)}),r.css(s).stop().animate(o,this.options.speed,this.options.easing),this.$sliderElem.stop().animate({left:this.$thumbs.eq(e).position().left},this.options.speed)).done(function(){n.css("opacity",0).find("div.ei-title > *").css("opacity",0),i.current=e,i.isAnimating=!1})},_initEvents:function(){var n=this;t(e).on("smartresize.eislideshow",function(e){n._setImagesSize(),n.$sliderElem.css("left",n.$thumbs.eq(n.current).position().left)}),this.$thumbs.on("click.eislideshow",function(e){n.options.autoplay&&(clearTimeout(n.slideshow),n.options.autoplay=!1);var r=t(this),i=r.index()-1;return n._slideTo(i),!1})}};var s=function(e){this.console&&console.error(e)};t.fn.eislideshow=function(e){if(typeof e=="string"){var n=Array.prototype.slice.call(arguments,1);this.each(function(){var r=t.data(this,"eislideshow");if(!r){s("cannot call methods on eislideshow prior to initialization; attempted to call method '"+e+"'");return}if(!t.isFunction(r[e])||e.charAt(0)==="_"){s("no such method '"+e+"' for eislideshow instance");return}r[e].apply(r,n)})}else this.each(function(){var n=t.data(this,"eislideshow");n||t.data(this,"eislideshow",new t.Slideshow(e,this))});return this}})(window,jQuery);